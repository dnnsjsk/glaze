function _(t,e,n=!1){var l;let i="string"!=typeof e?null==(l=null==e?void 0:e.selector)?void 0:l.value:"";if(i){if(i=i.replaceAll("_"," "),i.startsWith("&")){const e=null==i?void 0:i.replace("&",":scope");return":scope"===e?t:n?t.querySelector(e):t.querySelectorAll(e)}return i}return t}function J(t){return!(null===t||"object"!=typeof t||Array.isArray(t)||t instanceof HTMLElement)}function M(t,...e){if(!e.length)return t;const n=e.shift();if(J(t)&&J(n))for(const e in n)"__proto__"===e||"constructor"===e||"prototype"===e||(J(n[e])?(t[e]||Object.assign(t,{[e]:{}}),M(t[e],n[e])):Object.assign(t,{[e]:n[e]}));return e.length?M(t,...e):t}function G(t){const e=t.match(/^\[([^\]]+)]:(.*)/);return e?{content:e[1],restOfString:e[2]}:null}function K(t,e,n){if("string"!=typeof t)return t;const l=t.replace(/^\[|]$/g,"").replaceAll("_"," ");return l.startsWith("&")?_(e,{selector:{value:l}},["scrollTrigger","trigger"].includes(n)):"true"===l||"false"===l?"true"===l:isNaN(Number(l))?l:l.includes(".")?parseFloat(l):parseInt(l,10)}function C(t,e=!1,n){const l={};return t.split(" ").forEach((t=>{var i;const r=G(t);r&&(t=r.restOfString,l.selector={},l.selector.value=r.content);const s=t.split(":").filter((t=>!t.includes("@"))),[o,a]=s;if(!a&&e){const e=t.split("-"),i=e[0],r=e[1];if(!i||!r)return;return void(l[i]=K(r,n,i))}if("tl"===o&&a.startsWith("["))return void(l.tl={value:null==(i=G(a+":"))?void 0:i.content});if(!a)return;const c=a.split("|");l[o]||(l[o]={}),c.forEach((t=>{if(!t)return;let[e,i]=t.split(/-(.+)/);i=K(i,n,e);const r=e.split(".");let s=l[o];r.forEach(((t,e)=>{e===r.length-1?s[t]=i:(s[t]||(s[t]={}),s=s[t])}))}))})),l}function tt(t,e,n){const l=t.match(/(?:@(\w+):)?tl(?:\/(\w+))?/);if(l){const t=l[1],i={id:l[2]??"",breakpoint:n};if(t){if(null==e||!e[t])return null;i.breakpoint=e[t]??n}return i}return null}function et(t,e,n){const l={};return t.split(" ").forEach((t=>{const i=t.match(/@(\w+):/);if(!i)return l[n]||(l[n]=[]),void l[n].push(t);const r=i[1],s=null==e?void 0:e[r];s&&(l[s]||(l[s]=[]),l[s].push(t.replace(i[0],"")))})),l}function st(t,e){let n=null;return function(...l){null!==n&&clearTimeout(n),n=window.setTimeout((()=>{t(...l)}),e)}}function rt(t){var e,n,l;if(!t||null==(n=null==(e=null==t?void 0:t.lib)?void 0:e.gsap)||!n.core)throw new Error("GSAP not found");const{lib:{gsap:{core:i}},...r}=t,s=M({breakpoints:{default:"(min-width: 1px)"},dataAttribute:"data-animate",element:document,watch:!1},r);let o=0;const a=null==(l=s.breakpoints)?void 0:l.default,c=s.breakpoints,u=[],f=(t=!1)=>`${t?"[":""}${s.dataAttribute}${t?"]":""}`,d=t=>{const e=t.getAttribute(f())||"";let n="";null!=s&&s.className&&(n=(t.getAttribute("class")||"").split(" ").filter((t=>t.includes(s.className))).map((t=>t.replace(`${null==s?void 0:s.className}-`,""))).join(" "));let l="";const i=`${e} ${n}`.trim();return null!=s&&s.presets&&(Object.entries(s.presets).forEach((([t,e])=>{i.split(" ").forEach((n=>{n===`preset-${t}`&&(l+=` ${e}`)}))})),l=l.trim()),`${i} ${l}`.trim()},m=(t=s.element)=>Array.from(t.querySelectorAll(`${f(!0)}${s.className?`, [class^="${s.className}"], [class*="${s.className}"]`:""}`)),p=()=>(o++,`${Math.random().toString(36).substring(2,15)}-${o}`),h=t=>"tl"===t||t.includes("tl/")||t.endsWith(":tl"),v=t=>u.find((e=>e.elements.has(t))),b=t=>{const e=t.id,n=u.findIndex((t=>t.id===e));e&&-1!==n?u[n]={...t,timeline:u[n].timeline}:u.push(t)};function g(t){var e;const n=N(t),l=null==(e=u.find((e=>e.elements.has(t))))?void 0:e.elements.get(t);return JSON.stringify(n)!==JSON.stringify(l)&&(!l||!n||JSON.stringify(n)!==JSON.stringify(l))}const E=st((function(t){var e;const n=v(t);if(null==n||!n.timeline){let n="";if(Object.values(N(t)).forEach((t=>{n||t.tl&&(n=Object.keys(t.tl)[0])})),n||(n=(null==(e=(t=>u.find((e=>e.timelineElement===t||e.timelineElement.id&&t.id&&e.timelineElement.id===t.id)))(t))?void 0:e.id)||""),!n)return void $([t],p());const l=(t=>u.find((e=>e.id===t)))(n),i=[null==l?void 0:l.timelineElement,...(null==l?void 0:l.elements.keys())||[],t];return null==l||l.timeline.progress(0).clear(),void $(i,n)}$([...Array.from(n.elements.keys()),...null!=n&&n.timelineElement?[null==n?void 0:n.timelineElement]:[]],(null==n?void 0:n.id)||"")}),"object"==typeof s.watch&&s.watch.debounceTime||500);function N(t){const e=[...Object.entries(et(d(t),c,a)).map((([e,n])=>({breakpoint:e,element:t,data:C(n.join(" "),!1,t)})))],n={};return e.forEach((t=>{null!=n&&n[t.breakpoint]||(n[t.breakpoint]={}),n[t.breakpoint]=t.data})),n}function y(t=m(),e=""){const n=[];t.forEach((t=>{d(t).split(" ").some((t=>h(t)))&&(n.push(...function(t,e=""){var n;const l=[],r=d(t),o=r.split(" ");if(o.some((t=>h(t)))){const u=tt(r,c,a),f=new Map;[...m(t),...null!=u&&u.id?s.element.querySelectorAll(`[${s.dataAttribute}*="tl:${u.id}"]${s.className?`, [class^="${s.className}-tl:${u.id}"], [class*="${s.className}-tl:${u.id}"]`:""}`):[]].forEach((e=>{e!==t&&(f.set(e,N(e)),l.push(e))}));const d=C(o.filter((t=>!h(t))).join(" "),!0,t);let v={};null!=(n=s.defaults)&&n.tl&&(v=C(s.defaults.tl,!0,t));const g={};M(g,v,d);const E=(null==u?void 0:u.breakpoint)||a;b({breakpoint:E,data:g,elements:f,id:e||(null==u?void 0:u.id)||p(),timelineElement:t,timeline:i.timeline({...g,paused:!0})})}return l}(t)),n.push(t))})),t.forEach((t=>{var l,r;if(n.includes(t))return;const o=null==(l=u.find((e=>{var n;return(null==(n=e.elements)?void 0:n.has(t))&&e.breakpoint})))?void 0:l.breakpoint,c=v(t),f=new Map;if(!c||""!==e){const n=N(t);let l=null;Object.values(n).forEach((t=>{Object.values(t).forEach((t=>{t.scrollTrigger&&(l=t.scrollTrigger,delete t.scrollTrigger)}))})),f.set(t,n);const u=l?{scrollTrigger:l}:{};let d={};null!=(r=s.defaults)&&r.tl&&(d=C(s.defaults.tl,!0,t));const m={};M(m,d,u),b({breakpoint:o||a,data:u,elements:f,id:e||(null==c?void 0:c.id)||p(),timelineElement:t,timeline:i.timeline({...m,paused:!0})})}}))}function A(t){t.elements.forEach(((t,e)=>{i.set(e,{clearProps:"all"}),Object.values(t).forEach((t=>{t.selector&&i.set(_(e,t),{clearProps:"all"})}))}))}function $(t=m(),e=""){y(t,e),i.matchMedia().add(Object.fromEntries(Object.values({[a]:a,...c||{}}).map((t=>[t,t]))),(t=>{const n=[];return(e?[u.find((t=>t.id===e))]:u).reduce(((t,e)=>new Map([...t,...e.elements])),new Map).forEach(((e,l)=>{var i;let r={};Object.entries(e).forEach((([e,n])=>{var l;null!=(l=t.conditions)&&l[e]&&M(r,n)})),null!=(i=null==s?void 0:s.defaults)&&i.element&&M(r,C(s.defaults.element,!1,l));const o=v(l);o&&(n.includes(o.id)||(n.push(o.id),o.timeline.progress(0).clear(),A(o)),function(t,e,n){var l;const i=e.tl?null==(l=Object.values(e.tl))?void 0:l[0]:void 0;if(e.to&&e.from)n.fromTo(_(t,e),e.from,e.to,i);else if(e.to||e.from){const l=e.to?"to":"from";n[l](_(t,e),e[l],i)}}(l,r,o.timeline),(!o.timeline.scrollTrigger||o.timeline.scrollTrigger&&o.timeline.scrollTrigger.isActive)&&o.timeline.restart())})),()=>u.forEach((t=>A(t)))}))}return $(),s.watch&&function(){const t=s.element,e=new MutationObserver((function(t){t.forEach((function(t){var e;const n="attributes"===t.type&&t.attributeName===s.dataAttribute,l=s.className&&"class"===t.attributeName&&(null==(e=t.target.getAttribute("class"))?void 0:e.includes(s.className));if(n||l||"childList"===t.type){if("childList"===t.type)return void t.addedNodes.forEach((t=>{var e;if(t.nodeType===Node.ELEMENT_NODE){const n=t;if(n.hasAttribute(s.dataAttribute)||s.className&&null!=(e=n.getAttribute("class"))&&e.includes(s.className)){if(!g(n))return;return void E(n)}{const t=function(t){let e=t.parentElement;for(;e;){if(e.hasAttribute(s.dataAttribute)||Array.from(e.classList).some((t=>t.startsWith(s.className||"")))&&s.watch)return e;e=e.parentElement}return null}(n);if(!t)return;if(t)return console.log("mutation - childList: closest matching ancestor"),void E(t)}}}));g(t.target)&&E(t.target)}}))})),n={attributes:!0,attributeFilter:[s.dataAttribute,...s.className?["class"]:[]],subtree:!0,childList:!0};e.observe(t,n)}(),{breakpoints:c,state:s,timelines:u}}export{rt as default};